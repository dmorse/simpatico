<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>Simpatico: Data Structures (mcSim and mdSim)</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.7.3 -->
<div id="top">
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">Simpatico&#160;<span id="projectnumber">v1.0</span></div>
  </td>
 </tr>
 </tbody>
</table>
</div>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li><a href="dirs.html"><span>Directories</span></a></li>
    </ul>
  </div>
  <div id="nav-path" class="navpath">
    <ul>
      <li class="navelem"><a class="el" href="index.html">Simpatico - Simulation Package for Polymer and Molecular Liquids</a>      </li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="headertitle">
<h1>Data Structures (mcSim and mdSim) </h1>  </div>
</div>
<div class="contents">
<div class="textblock"><p>In this section, we discuss details of how the most important data structures are organized in the implementation of the mcSim and mdSim single-processor programs. The organization of data in the parallel ddSim program is signficantly different.</p>
<p>The underlying organization of memory in mcSim and mdSim is not apparent from the public interface. The public interface of the <a class="el" href="classMcMd_1_1System.html" title="A set of interacting Molecules enclosed by a Boundary.">System</a> class allows <a class="el" href="classMcMd_1_1Molecule.html" title="A physical molecule (a set of covalently bonded Atoms).">Molecule</a> objects to be accessed only through methods of a <a class="el" href="classMcMd_1_1System.html" title="A set of interacting Molecules enclosed by a Boundary.">System</a> that either return a <a class="el" href="classMcMd_1_1Molecule.html" title="A physical molecule (a set of covalently bonded Atoms).">Molecule</a> of a particular species by reference, or initialize an iterator for all molecules of one <a class="el" href="classMcMd_1_1Species.html" title="A Species represents a set of chemically similar molecules.">Species</a>. To access a particular atom, one must first obtain a reference or pointer to the parent <a class="el" href="classMcMd_1_1Molecule.html" title="A physical molecule (a set of covalently bonded Atoms).">Molecule</a>, and then invoke a method of the <a class="el" href="classMcMd_1_1Molecule.html" title="A physical molecule (a set of covalently bonded Atoms).">Molecule</a> that either returns a particular <a class="el" href="classMcMd_1_1Atom.html" title="A point particle within a Molecule.">Atom</a> by reference or that initializes an iterator for all atoms in one <a class="el" href="classMcMd_1_1Molecule.html" title="A physical molecule (a set of covalently bonded Atoms).">Molecule</a>. Particular Group&lt;NAtom&gt; objects within a molecule, which represent covalent bonds (NAtom=2), angle groups and torsion groups can be accessed by patterns similar to those used for access Atoms.</p>
<p>The implementation of Simpatico actually uses a set of large arrays of <a class="el" href="classMcMd_1_1Molecule.html" title="A physical molecule (a set of covalently bonded Atoms).">Molecule</a>, <a class="el" href="classMcMd_1_1Atom.html" title="A point particle within a Molecule.">Atom</a>, and <a class="el" href="classMcMd_1_1Group.html" title="A group of covalently interacting atoms.">Group</a> objects, each of which acts as a sort of memory pool. Each of these arrays is a private member of the main <a class="el" href="classMcMd_1_1Simulation.html" title="The main object in a simulation, which coordinates others.">Simulation</a> object, and is allocated during the initialization of the simulation. Each of these arrays holds all of the <a class="el" href="classMcMd_1_1Molecule.html" title="A physical molecule (a set of covalently bonded Atoms).">Molecule</a>, <a class="el" href="classMcMd_1_1Atom.html" title="A point particle within a Molecule.">Atom</a>, and <a class="el" href="classMcMd_1_1Group.html" title="A group of covalently interacting atoms.">Group</a> objects that are available for use by molecules of any <a class="el" href="classMcMd_1_1Species.html" title="A Species represents a set of chemically similar molecules.">Species</a> in any <a class="el" href="classMcMd_1_1System.html" title="A set of interacting Molecules enclosed by a Boundary.">System</a> during a simulation.</p>
<p>Each molecule object is permanently associated with a block of <a class="el" href="classMcMd_1_1Atom.html" title="A point particle within a Molecule.">Atom</a> objects in the global <a class="el" href="classMcMd_1_1Atom.html" title="A point particle within a Molecule.">Atom</a> array, a block of Bond (i.e,. <a class="el" href="classDdMd_1_1Group.html">Group&lt;2&gt;</a>) objects in the global array of Bond objects, and so forth for Angle (Group&lt;3&gt;) and Torsion (Group&lt;4&gt;) objects. This association of each molecule with blocks of constitutent objects is created immediately after these arrays are allocated, by setting pointer members of each molecule to point to the first element of the associated blocks of <a class="el" href="classMcMd_1_1Atom.html" title="A point particle within a Molecule.">Atom</a> and Group&lt;NAtom&gt; objects. This association of <a class="el" href="classMcMd_1_1Molecule.html" title="A physical molecule (a set of covalently bonded Atoms).">Molecule</a> objects with blocks of atoms and groups is permanent: It is never changed after it is created. Each <a class="el" href="classMcMd_1_1Atom.html" title="A point particle within a Molecule.">Atom</a> object also has a pointer to its parent <a class="el" href="classMcMd_1_1Molecule.html" title="A physical molecule (a set of covalently bonded Atoms).">Molecule</a>, and each <a class="el" href="classMcMd_1_1Molecule.html" title="A physical molecule (a set of covalently bonded Atoms).">Molecule</a> has a pointer to its parent <a class="el" href="classMcMd_1_1Species.html" title="A Species represents a set of chemically similar molecules.">Species</a>, which are also set during initialization of the <a class="el" href="classMcMd_1_1Simulation.html" title="The main object in a simulation, which coordinates others.">Simulation</a>, and unchanged thereafter.</p>
<p><a class="el" href="classMcMd_1_1Molecule.html" title="A physical molecule (a set of covalently bonded Atoms).">Molecule</a> objects and associated blocks of atoms and <a class="el" href="classMcMd_1_1Group.html" title="A group of covalently interacting atoms.">Group</a> objects are never created or destroyed after initialization. Ownership of a <a class="el" href="classMcMd_1_1Molecule.html" title="A physical molecule (a set of covalently bonded Atoms).">Molecule</a> may, however, be transferred between a reservoir of unused molecules of that <a class="el" href="classMcMd_1_1Species.html" title="A Species represents a set of chemically similar molecules.">Species</a> and a <a class="el" href="classMcMd_1_1System.html" title="A set of interacting Molecules enclosed by a Boundary.">System</a>, or (in Gibbs ensemble) between two Systems, by transferring a pointer to the molecule between appropriate containers. This is discussed in more detail below.</p>
<p><b> Molecules </b></p>
<p>The private molecules_ array container of a <a class="el" href="classMcMd_1_1Simulation.html" title="The main object in a simulation, which coordinates others.">Simulation</a> holds all of the <a class="el" href="classMcMd_1_1Molecule.html" title="A physical molecule (a set of covalently bonded Atoms).">Molecule</a> objects of that are available for all <a class="el" href="classMcMd_1_1Species.html" title="A Species represents a set of chemically similar molecules.">Species</a> in a <a class="el" href="classMcMd_1_1Simulation.html" title="The main object in a simulation, which coordinates others.">Simulation</a>. Each species is assigned a contiguous block of <a class="el" href="classMcMd_1_1Molecule.html" title="A physical molecule (a set of covalently bonded Atoms).">Molecule</a> elements within this array.</p>
<p>The number of molecules that is allocated for each species is the capacity of the <a class="el" href="classMcMd_1_1Species.html" title="A Species represents a set of chemically similar molecules.">Species</a>. The capacity of the molecules_ array is thus given by the sum of the values of capacity() for all <a class="el" href="classMcMd_1_1Species.html" title="A Species represents a set of chemically similar molecules.">Species</a>. The capacity of each species is specified in the parameter file. In Canonical and Gibbs ensembles, the total number of molecules of each <a class="el" href="classMcMd_1_1Species.html" title="A Species represents a set of chemically similar molecules.">Species</a> is fixed, and so the capacity can be set equal to this actual number of molecules. In grand canonical ensembles, the <a class="el" href="classMcMd_1_1Species.html" title="A Species represents a set of chemically similar molecules.">Species</a> capacity must be chosen to be large enough to accomodate any fluctuations that might be encountered during the simulation.</p>
<p>Each <a class="el" href="classMcMd_1_1System.html" title="A set of interacting Molecules enclosed by a Boundary.">System</a> in a <a class="el" href="classMcMd_1_1Simulation.html" title="The main object in a simulation, which coordinates others.">Simulation</a> has a container for each <a class="el" href="classMcMd_1_1Species.html" title="A Species represents a set of chemically similar molecules.">Species</a> that that holds pointers to Molecules of that <a class="el" href="classMcMd_1_1Species.html" title="A Species represents a set of chemically similar molecules.">Species</a> that are currently in the <a class="el" href="classMcMd_1_1System.html" title="A set of interacting Molecules enclosed by a Boundary.">System</a>. In addition, each <a class="el" href="classMcMd_1_1Species.html" title="A Species represents a set of chemically similar molecules.">Species</a> object has a container, known as a reservoir, that holds pointers to "unused" molecules within the block of memory reserved for that species. The reservoir is implemented as a stack of pointers to <a class="el" href="classMcMd_1_1Molecule.html" title="A physical molecule (a set of covalently bonded Atoms).">Molecule</a> objects (an ArrayStack &lt; <a class="el" href="classMcMd_1_1Molecule.html" title="A physical molecule (a set of covalently bonded Atoms).">Molecule</a> &gt; container). The typedef <a class="el" href="classMcMd_1_1Species.html#af1ce4ecf5e4b10bee98184e89ea71f70" title="A stack of unused Molecule objects available for this Species.">Species::Reservoir</a> is a synonym for ArrayStack &lt; <a class="el" href="classMcMd_1_1Molecule.html" title="A physical molecule (a set of covalently bonded Atoms).">Molecule</a> &gt;. The container used by each <a class="el" href="classMcMd_1_1System.html" title="A set of interacting Molecules enclosed by a Boundary.">System</a> to hold molecules of one <a class="el" href="classMcMd_1_1Species.html" title="A Species represents a set of chemically similar molecules.">Species</a> is an ArraySet &lt; <a class="el" href="classMcMd_1_1Molecule.html" title="A physical molecule (a set of covalently bonded Atoms).">Molecule</a> &gt; object. The typedef <a class="el" href="classMcMd_1_1System.html#a5d50409f526dbaa0e0048d12356e1ffd" title="A set of molecules of one Species in a System.">System::MoleculeSet</a> is a synonym for ArraySet &lt; <a class="el" href="classMcMd_1_1Molecule.html" title="A physical molecule (a set of covalently bonded Atoms).">Molecule</a> &gt;. An ArraySet &lt; <a class="el" href="classMcMd_1_1Molecule.html" title="A physical molecule (a set of covalently bonded Atoms).">Molecule</a> &gt; is a container for <a class="el" href="classMcMd_1_1Molecule.html" title="A physical molecule (a set of covalently bonded Atoms).">Molecule</a> pointers that provides rapid O(1) random access and O(1) insertion and deletion, but that generally changes the order in which the Molecule* pointers are stored when a <a class="el" href="classMcMd_1_1Molecule.html" title="A physical molecule (a set of covalently bonded Atoms).">Molecule</a> is removed.</p>
<p>When a <a class="el" href="classMcMd_1_1Simulation.html" title="The main object in a simulation, which coordinates others.">Simulation</a> is initialized, all the molecules of each <a class="el" href="classMcMd_1_1Species.html" title="A Species represents a set of chemically similar molecules.">Species</a> are initially pushed onto the associated reservoir. Ownership of some or all of the molecules of each species is then transferred to a <a class="el" href="classMcMd_1_1System.html" title="A set of interacting Molecules enclosed by a Boundary.">System</a> when a configuration file is read. The configuration file for a <a class="el" href="classMcMd_1_1System.html" title="A set of interacting Molecules enclosed by a Boundary.">System</a> contains the actual number of molecules of each species in that <a class="el" href="classMcMd_1_1System.html" title="A set of interacting Molecules enclosed by a Boundary.">System</a>, as well as all of the atomic coordinates. Ownership of a molecule is transferred from the reservoir to a <a class="el" href="classMcMd_1_1System.html" title="A set of interacting Molecules enclosed by a Boundary.">System</a> by popping a molecule off the reservoir, using the pop() method of the Reservoir container, and then calling System::AddMolecule(Molecule&amp;) to add it to the MoleculeSet for that <a class="el" href="classMcMd_1_1Species.html" title="A Species represents a set of chemically similar molecules.">Species</a> in the <a class="el" href="classMcMd_1_1System.html" title="A set of interacting Molecules enclosed by a Boundary.">System</a>.</p>
<p>This data structure is designed to accomodate later implementation of simulations of open ensembles, in which molecules may be added to and removed from a <a class="el" href="classMcMd_1_1System.html" title="A set of interacting Molecules enclosed by a Boundary.">System</a> during a simulation. In grand-canonical ensemble, a <a class="el" href="classMcMd_1_1Molecule.html" title="A physical molecule (a set of covalently bonded Atoms).">Molecule</a> may be transferred from a reservoir to a <a class="el" href="classMcMd_1_1System.html" title="A set of interacting Molecules enclosed by a Boundary.">System</a> by the same procedure as that used when reading a configuration file, and may be removed from a system by calling the system removeMolecule(Molecule&amp;) method and then pushing the molecule onto the appropriate reservoir. In Gibbs ensemble, a <a class="el" href="classMcMd_1_1Molecule.html" title="A physical molecule (a set of covalently bonded Atoms).">Molecule</a> may be transferred from one <a class="el" href="classMcMd_1_1System.html" title="A set of interacting Molecules enclosed by a Boundary.">System</a> to another by invoking the addMolecule() and removeMolecule() methods of the two <a class="el" href="classMcMd_1_1System.html" title="A set of interacting Molecules enclosed by a Boundary.">System</a>.</p>
<p>The organization of data in Simpatico is a result of the desire to: (1) Avoid dynamical allocation of memory after initialization of the simulation, (2) Arrange memory as much as possible in contiguous arrays, and (3) Allow for eventual extension to open ensemble simulations. Criteria (1) and (2) were motivated by efficiency considerations, in the belief that these criteria might be necessary to implement molecular dynamics with an efficiency that rivals that of well optimized MD programs.</p>
<p><b> <a class="el" href="classMcMd_1_1Atom.html" title="A point particle within a Molecule.">Atom</a> Objects </b></p>
<p>The atoms_ array of a <a class="el" href="classMcMd_1_1Simulation.html" title="The main object in a simulation, which coordinates others.">Simulation</a> holds all of the <a class="el" href="classMcMd_1_1Atom.html" title="A point particle within a Molecule.">Atom</a> objects that are available in a simulation, for all molecules of all species. When the initialization of a <a class="el" href="classMcMd_1_1Simulation.html" title="The main object in a simulation, which coordinates others.">Simulation</a> is completed, each <a class="el" href="classMcMd_1_1Molecule.html" title="A physical molecule (a set of covalently bonded Atoms).">Molecule</a> object is associated with a contiguous block of <a class="el" href="classMcMd_1_1Atom.html" title="A point particle within a Molecule.">Atom</a> objects within this array. Molecules of the same <a class="el" href="classMcMd_1_1Species.html" title="A Species represents a set of chemically similar molecules.">Species</a> are associated with contiguous blocks of Atoms within this array, creating a larger block of <a class="el" href="classMcMd_1_1Atom.html" title="A point particle within a Molecule.">Atom</a> objects associated with the <a class="el" href="classMcMd_1_1Species.html" title="A Species represents a set of chemically similar molecules.">Species</a>. The size of the atoms_ array is chosen to be large enough to hold all of the Atoms associated with all molecules of all species. As already noted, the association between Molecules and blocks of Atoms is created during initialization, by setting a pointer in each <a class="el" href="classMcMd_1_1Molecule.html" title="A physical molecule (a set of covalently bonded Atoms).">Molecule</a> to point to the first <a class="el" href="classMcMd_1_1Atom.html" title="A point particle within a Molecule.">Atom</a> in the associated block of the atoms_ array, and setting a pointer for each <a class="el" href="classMcMd_1_1Atom.html" title="A point particle within a Molecule.">Atom</a> that points to the parent <a class="el" href="classMcMd_1_1Molecule.html" title="A physical molecule (a set of covalently bonded Atoms).">Molecule</a> object.</p>
<p><b> <a class="el" href="classMcMd_1_1Group.html" title="A group of covalently interacting atoms.">Group</a> Objects </b></p>
<p>The <a class="el" href="classMcMd_1_1Group.html" title="A group of covalently interacting atoms.">Group</a> objects of each type (i.e., Bonds, Angle, and Torsion objects) are also stored in a set of global arrays, which are DArray container members of the <a class="el" href="classMcMd_1_1Simulation.html" title="The main object in a simulation, which coordinates others.">Simulation</a> object. It is sufficient to discuss the Bond (or <a class="el" href="classDdMd_1_1Group.html">Group&lt;2&gt;</a>) objects. All Bond objects needed construct all molecules of all <a class="el" href="classMcMd_1_1Species.html" title="A Species represents a set of chemically similar molecules.">Species</a> are held in the bonds_ array. The organization of this array is closely analogous to that of the atoms_ array: Each <a class="el" href="classMcMd_1_1Molecule.html" title="A physical molecule (a set of covalently bonded Atoms).">Molecule</a> is associated with a contiguous block of Bond objects, with consecutive Molecules consecutive blocks. Each <a class="el" href="classMcMd_1_1Molecule.html" title="A physical molecule (a set of covalently bonded Atoms).">Molecule</a> contains a pointer to the first Bond in the associated Block. Each Bond contains pointers to the two associated <a class="el" href="classMcMd_1_1Atom.html" title="A point particle within a Molecule.">Atom</a> objects in the atoms_ array, and a bond type index. The identities of the two <a class="el" href="classMcMd_1_1Atom.html" title="A point particle within a Molecule.">Atom</a> objects are established during initialization of the simulation, using the description of covalent structure that is stored in the associate <a class="el" href="classMcMd_1_1Species.html" title="A Species represents a set of chemically similar molecules.">Species</a> object, and never changes thereafter.</p>
<p>Arrays of Angle (Group&lt;3&gt;) and Torsion (Group&lt;4&gt;) objects have not yet been added, but will be organized and initialized in a manner closely analogous to that used for Bond objects.</p>
<p><b> Defining Chemical Structure: <a class="el" href="classMcMd_1_1SpeciesGroup.html" title="A Group of covalently interacting atoms within any molecule of one Species.">SpeciesGroup</a> Objects </b></p>
<p>Each <a class="el" href="classMcMd_1_1Species.html" title="A Species represents a set of chemically similar molecules.">Species</a> object contains a set of <a class="el" href="classMcMd_1_1SpeciesGroup.html" title="A Group of covalently interacting atoms within any molecule of one Species.">SpeciesGroup</a> objects that specify the chemical structure of a generic <a class="el" href="classMcMd_1_1Molecule.html" title="A physical molecule (a set of covalently bonded Atoms).">Molecule</a> of that <a class="el" href="classMcMd_1_1Species.html" title="A Species represents a set of chemically similar molecules.">Species</a>. The set of Atoms involved in an N-body covalent interaction (i.e., a 2-body Bond, a 3-body Angle, or a 4-body torsion) are specified in a <a class="el" href="classMcMd_1_1SpeciesGroup.html" title="A Group of covalently interacting atoms within any molecule of one Species.">SpeciesGroup</a> &lt; N &gt; object as a set of integer atom indices, in which the atoms of each molecule are indexed from 0 within each molecule. The resulting description of chemical structure of a generic molecule is used during initialization to assign pointers to specific <a class="el" href="classMcMd_1_1Atom.html" title="A point particle within a Molecule.">Atom</a> objects to <a class="el" href="classMcMd_1_1Group.html" title="A group of covalently interacting atoms.">Group</a> objects that are associated with specific Molecules. Each <a class="el" href="classMcMd_1_1SpeciesGroup.html" title="A Group of covalently interacting atoms within any molecule of one Species.">SpeciesGroup</a> is thus a template for initializing one <a class="el" href="classMcMd_1_1Group.html" title="A group of covalently interacting atoms.">Group</a> within each molecule of the associated species.</p>
<p><b> Initialization Process</b></p>
<p>All required initialization of a simulation is done within the readParam() method of the main <a class="el" href="classMcMd_1_1Simulation.html" title="The main object in a simulation, which coordinates others.">Simulation</a> object. More generally, the initialization of each object in Simpatico is, as much as possible, carried out entirely within its readParam method. The readParam methods of <a class="el" href="classMcMd_1_1McSimulation.html" title="A Monte-Carlo simulation of one McSystem.">McSimulation</a> and <a class="el" href="classMcMd_1_1MdSimulation.html" title="A molecular dynamics simulation of a single MdSystem.">MdSimulation</a> subclasses both call <a class="el" href="classMcMd_1_1Simulation.html#ac4c728d86768de8f28e70067869ce768" title="Read parameter file and initialize.">Simulation::readParam()</a> to carry out the initialization of basic data structures required by both types of <a class="el" href="classMcMd_1_1Simulation.html" title="The main object in a simulation, which coordinates others.">Simulation</a>.</p>
<p>Before allocating any memory for the data structures described above, <a class="el" href="classMcMd_1_1Simulation.html#ac4c728d86768de8f28e70067869ce768" title="Read parameter file and initialize.">Simulation::readParam()</a> method invokes the readParam method of the <a class="el" href="classMcMd_1_1SpeciesManager.html" title="A Manager for a set of Species objects.">SpeciesManager</a>. This calls the readParam method of each species, and thus determines the capacity of each species (i.e., the number of molecules to be allocated) and the number of atoms, bonds, etc. per molecule of each species. This information is used to calculate the total number of molecules, atoms, and bonds needed, and the associated global arrays are allocated. After associations between molecules and blocks of <a class="el" href="classMcMd_1_1Atom.html" title="A point particle within a Molecule.">Atom</a> and Group&lt;N&gt; objects are created, Bond objects are initialized, and atom type ids are set, using the public interface of the <a class="el" href="classMcMd_1_1Species.html" title="A Species represents a set of chemically similar molecules.">Species</a> class to describe the chemical structure of each species.</p>
<p>The last step of <a class="el" href="classMcMd_1_1Simulation.html#ac4c728d86768de8f28e70067869ce768" title="Read parameter file and initialize.">Simulation::readParam()</a> is to push all of the molecules of each <a class="el" href="classMcMd_1_1Species.html" title="A Species represents a set of chemically similar molecules.">Species</a> onto the associated reservoir. Molecules are initially added to the reservoir in reverse order, so that the first (lowest address) molecule is at the top of the stack. This is so that they can be popped off in sequential order (first molecule first), when the configuration file is read. The readParam() method of an <a class="el" href="classMcMd_1_1McSimulation.html" title="A Monte-Carlo simulation of one McSystem.">McSimulation</a> or <a class="el" href="classMcMd_1_1MdSimulation.html" title="A molecular dynamics simulation of a single MdSystem.">MdSimulation</a> also calls the readParam() method for the associated <a class="el" href="classMcMd_1_1System.html" title="A set of interacting Molecules enclosed by a Boundary.">System</a> object, which allocates and initializes the container for each <a class="el" href="classMcMd_1_1Species.html" title="A Species represents a set of chemically similar molecules.">Species</a> in the associated <a class="el" href="classMcMd_1_1System.html" title="A set of interacting Molecules enclosed by a Boundary.">System</a>. After the main readParam() method returns, the <a class="el" href="classMcMd_1_1System.html" title="A set of interacting Molecules enclosed by a Boundary.">System</a> is empty, but is ready to read a configuration file.</p>
<p>The config file for a <a class="el" href="classMcMd_1_1System.html" title="A set of interacting Molecules enclosed by a Boundary.">System</a> is read by an associated <a class="el" href="classMcMd_1_1ConfigIo.html" title="System configuration file reader and writer.">ConfigIo</a> object. When a config file is read, ownership of a specified number of molecules of each species (less than or equal to the capacity) is transferred from the reservoir to the <a class="el" href="classMcMd_1_1System.html" title="A set of interacting Molecules enclosed by a Boundary.">System</a>, and atomic positions are assigned to all atoms of these molecules. In simulations of closed systems, in which molecules are added to a <a class="el" href="classMcMd_1_1System.html" title="A set of interacting Molecules enclosed by a Boundary.">System</a> only when the configuration file is read, iteration over all molecules of a <a class="el" href="classMcMd_1_1Species.html" title="A Species represents a set of chemically similar molecules.">Species</a> will thus traverse the molecule array and the associated blocks of the <a class="el" href="classMcMd_1_1Atom.html" title="A point particle within a Molecule.">Atom</a> and <a class="el" href="classMcMd_1_1Group.html" title="A group of covalently interacting atoms.">Group</a> arrays sequentially.</p>
<p>In a long grand-canonical or Gibbs ensemble simulation, iteration over all molecules of a <a class="el" href="classMcMd_1_1Species.html" title="A Species represents a set of chemically similar molecules.">Species</a> within one <a class="el" href="classMcMd_1_1System.html" title="A set of interacting Molecules enclosed by a Boundary.">System</a> will eventually lead to a random pattern access of Molecules and associated blocks of Atoms and Groups.</p>
<p><b> <a class="el" href="classMcMd_1_1Atom.html" title="A point particle within a Molecule.">Atom</a> Class Implementation </b></p>
<p>In order to keep each <a class="el" href="classMcMd_1_1Atom.html" title="A point particle within a Molecule.">Atom</a> object small for efficiency, the <a class="el" href="classMcMd_1_1Atom.html" title="A point particle within a Molecule.">Atom</a> class is implemented in a way that allows some of the logical attributes of an <a class="el" href="classMcMd_1_1Atom.html" title="A point particle within a Molecule.">Atom</a> to be stored in separate arrays, rather than as nonstatic members of the <a class="el" href="classMcMd_1_1Atom.html" title="A point particle within a Molecule.">Atom</a> class. All of the atom objects in a simulation are allocated in a single array, which is a private static member of the <a class="el" href="classMcMd_1_1Atom.html" title="A point particle within a Molecule.">Atom</a> class. The atoms_ array member of the main simulation object is actually an <a class="el" href="classUtil_1_1RArray.html">RArray&lt;Atom&gt;</a> container that holds the address and and capacity of this static array, and that thus acts as an alias for this array. Other private static array members of <a class="el" href="classMcMd_1_1Atom.html" title="A point particle within a Molecule.">Atom</a> are allocated for attributes of an <a class="el" href="classMcMd_1_1Atom.html" title="A point particle within a Molecule.">Atom</a> that are not actually members of an <a class="el" href="classMcMd_1_1Atom.html" title="A point particle within a Molecule.">Atom</a> object. In the current implementation, the <a class="el" href="classMcMd_1_1Mask.html" title="Set of Atoms for which pair interactions with a target Atom are &quot;masked&quot;.">Mask</a> associated with an atom, the pointer to its parent <a class="el" href="classMcMd_1_1Molecule.html" title="A physical molecule (a set of covalently bonded Atoms).">Molecule</a>, and the associated force and velocity Vectors are all stored in such separate arrays. The accessor and setter methods associated with these attributes directly access these arrays, thus providing an interface identical to what one would expect if these attributes were stored as members of the <a class="el" href="classMcMd_1_1Atom.html" title="A point particle within a Molecule.">Atom</a> object. In order for this scheme to work, however, we must prohibit instantiation of individual <a class="el" href="classMcMd_1_1Atom.html" title="A point particle within a Molecule.">Atom</a> objects (by making the default and copy constructors private). This scheme requires that all of the <a class="el" href="classMcMd_1_1Atom.html" title="A point particle within a Molecule.">Atom</a> objects in a simulation be allocated at once by calling the static <a class="el" href="classMcMd_1_1Atom.html#a2d2175ba5b0934a509650253a8254dab" title="Allocate a static array of Atom objects.">Atom::allocate()</a> method, which allocates both the array of <a class="el" href="classMcMd_1_1Atom.html" title="A point particle within a Molecule.">Atom</a> objects and associated arrays of atom attributes, all of which use the same indexing scheme.</p>
<p>This peculiar implementation of the <a class="el" href="classMcMd_1_1Atom.html" title="A point particle within a Molecule.">Atom</a> class was motivated by efficiency, and by consideration of the nature of the inner loop in the calculation of nonbonded interactions. The inner loop of the calculation of nonbonded pair interactions in either an MC or an MD simulation involves an iteration of the neighbors of a particular "root" atom (using either a cell list in MC or a Verlet list in MD). This requires access to the <a class="el" href="classMcMd_1_1Mask.html" title="Set of Atoms for which pair interactions with a target Atom are &quot;masked&quot;.">Mask</a> object associatd with the root atom, but requires access to only the position and type ids of its neighbors. The inner loop in MD also requires access to the force vector associated with both the root <a class="el" href="classMcMd_1_1Atom.html" title="A point particle within a Molecule.">Atom</a> and each interacting neighbor. In the current implementation, and <a class="el" href="classMcMd_1_1Atom.html" title="A point particle within a Molecule.">Atom</a> is a 32 byte object that contains only a position Vector, an atomic type id, and a global atom id, which is also the array index of the atom. In this case, an <a class="el" href="classMcMd_1_1Atom.html" title="A point particle within a Molecule.">Atom</a> object thus contains only the information required to calculate the pair interaction for each neighbor (its position and atomic type id) and the atom array index that is required to rapidly access the other attributes that are stored in separate arrays.</p>
<ul>
<li>
<a class="el" href="read_param_page.html">readParam() Methods</a> (Previous)  </li>
<li>
<a class="el" href="developer_page.html">Developer Information</a> (Up)  </li>
</ul>
</div></div>
<hr class="footer"/><address class="footer"><small>Generated on Sat Sep 1 2012 12:15:15 for Simpatico by&#160;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.3 </small></address>
</body>
</html>
